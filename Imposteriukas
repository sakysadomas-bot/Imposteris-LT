<!DOCTYPE html>
<html lang="lt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Apsimetėlis</title>

<style>
body {
  margin: 0;
  font-family: system-ui, sans-serif;
  background: #111;
  color: white;
  text-align: center;
}

.screen {
  display: none;
  padding: 30px;
}

.screen.active {
  display: block;
}

button {
  font-size: 18px;
  padding: 12px 20px;
  margin: 8px;
  border-radius: 10px;
  border: none;
}

.choice button {
  width: 70px;
}

#overlay {
  position: fixed;
  inset: 0;
  background: black;
  display: none;
  align-items: center;
  justify-content: center;
  font-size: 26px;
  padding: 20px;
}
</style>
</head>

<body>

<div id="overlay"></div>

<div id="players" class="screen active">
  <h2>Kiek žaidėjų?</h2>
  <div class="choice" id="playersBtns"></div>
</div>

<div id="imposters" class="screen">
  <h2>Kiek apsimetėlių?</h2>
  <button onclick="setImposters(1)">1</button>
  <button onclick="setImposters(2)">2</button>
  <button onclick="setImposters(3)">3</button>
</div>

<div id="time" class="screen">
  <h2>Kiek laiko rodyti?</h2>
  <button onclick="setTime(1500)">1.5 s</button>
  <button onclick="setTime(2000)">2 s</button>
  <button onclick="setTime(3000)">3 s</button>
  <button onclick="setTime(4000)">4 s</button>
</div>

<div id="game" class="screen">
  <h2 id="turn"></h2>
  <button onclick="show()">Rodyti</button>
</div>

<div id="end" class="screen">
  <h2>Pabaiga</h2>
  <button onclick="location.reload()">Žaisti dar kartą</button>
</div>

<script>
let players = 0;
let imposters = 1;
let showTime = 2000;
let index = 0;
let data = [];

const words = [
  "Marvel",
  "Avengers",
  "Spider-Man",
  "Iron Man",
  "Thor",
  "Pandoros džiunglės",
  "Avatar",
  "Na'vi",
  "Superherojus",
  "Piktadarys"
];

const overlay = document.getElementById("overlay");

for (let i = 3; i <= 10; i++) {
  const b = document.createElement("button");
  b.textContent = i;
  b.onclick = () => setPlayers(i);
  document.getElementById("playersBtns").appendChild(b);
}

function showScreen(id) {
  document.querySelectorAll(".screen").forEach(s => s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

function setPlayers(n) {
  players = n;
  showScreen("imposters");
}

function setImposters(n) {
  imposters = n;
  showScreen("time");
}

function setTime(t) {
  showTime = t;
  startGame();
}

function startGame() {
  const word = words[Math.floor(Math.random() * words.length)];
  data = Array(players).fill(word);

  let used = new Set();
  while (used.size < imposters) {
    used.add(Math.floor(Math.random() * players));
  }

  used.forEach(i => {
    data[i] = "TU APSIMETĖLIS – bandyk neišduoti, kad nežinai žodžio";
  });

  index = 0;
  showScreen("game");
  updateTurn();
}

function updateTurn() {
  if (index >= players) {
    showScreen("end");
    return;
  }
  document.getElementById("turn").textContent = `Žaidėjas ${index + 1}`;
}

function show() {
  const text = data[index];
  overlay.textContent = text;
  overlay.style.display = "flex";

  let t = showTime;
  if (text.startsWith("TU APSIMETĖLIS") && t < 3500) t = 3500;

  setTimeout(() => {
    overlay.style.display = "none";
    index++;
    updateTurn();
  }, t);
}
</script>

</body>
</html>
